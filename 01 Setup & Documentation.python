{"version":"NotebookV1","origId":1343992488731353,"name":"01 Setup & Documentation","language":"python","commands":[{"version":"CommandV1","origId":1343992488731450,"guid":"43a1a70a-22ab-421b-bcd3-b4d0d3281e5d","subtype":"command","commandType":"auto","position":0.25,"command":"%md\n# Koantek Parallel Load Utility\n\n","commandVersion":105,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e998cf45-c1ed-4066-9e8f-68965b463044"},{"version":"CommandV1","origId":1343992488731451,"guid":"269c0614-97a4-4483-8440-3eeace70af33","subtype":"command","commandType":"auto","position":0.3125,"command":"%md\n## Setup Procedure\n1. Database Setup\n1. JSON Configuration \n1. Writing JSON to disk from Notebook\n1. Scheduling Job for Execution","commandVersion":45,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"de70c850-51d2-4f05-9cd3-f0ddff548c14"},{"version":"CommandV1","origId":1343992488731452,"guid":"7e53652c-e3c2-45b0-a2e9-64fc7337dd71","subtype":"command","commandType":"auto","position":0.375,"command":"%md\n### Database Setup ( one time only per tracking server)","commandVersion":13,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2e1cac14-ca0b-420d-b4b5-a69b4fcd88bb"},{"version":"CommandV1","origId":1343992488731453,"guid":"1468c6c5-20bf-44ed-ac7d-68f9ff5b399c","subtype":"command","commandType":"auto","position":0.4375,"command":"%sql\nUSE koantek_triyam_test;\nCREATE OR REPLACE TABLE load_metrics\n(\n    table_name\tSTRING\n    ,load_begin\tTIMESTAMP\n    ,load_end\tTIMESTAMP\n    ,begin_rowcount BIGINT\n    ,end_rowcount BIGINT\n    ,rows_per_second FLOAT\n)","commandVersion":59,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"dataframeName":null}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1685558289666,"submitTime":1685558289636,"finishTime":1685558318754,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000,"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1230c5d9-3f5b-4eba-8a46-f3f57d5e95a1"},{"version":"CommandV1","origId":1343992488731455,"guid":"03317625-3789-457b-9ba2-ff5fb36f4a57","subtype":"command","commandType":"auto","position":7.265625,"command":"%sql\n--total duration of execution times in hours\nselect  \nSUM (UNIX_TIMESTAMP(load_end) - UNIX_TIMESTAMP(load_begin)) / 3600 \n from koantek_triyam_test.load_metrics","commandVersion":20,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[15.215555555555556]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"(sum((unix_timestamp(load_end, yyyy-MM-dd HH:mm:ss) - unix_timestamp(load_begin, yyyy-MM-dd HH:mm:ss))) / 3600)","type":"\"double\"","metadata":"{\"__autoGeneratedAlias\":\"true\"}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"__autoGeneratedAlias":"true"},"name":"(sum((unix_timestamp(load_end, yyyy-MM-dd HH:mm:ss) - unix_timestamp(load_begin, yyyy-MM-dd HH:mm:ss))) / 3600)","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"columnCustomDisplayInfos":{},"metadata":{"dataframeName":"_sqldf","executionCount":4}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"__autoGeneratedAlias":"true"},"name":"(sum((unix_timestamp(load_end, yyyy-MM-dd HH:mm:ss) - unix_timestamp(load_begin, yyyy-MM-dd HH:mm:ss))) / 3600)","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1686262636866,"submitTime":1686262636814,"finishTime":1686262638925,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000,"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d727445f-fc82-42bf-979e-fa1495942bb5"},{"version":"CommandV1","origId":1343992488731457,"guid":"0cba5a15-9e30-434d-a709-c96581842e5c","subtype":"command","commandType":"auto","position":0.5,"command":"%md \n### JSON Configuration","commandVersion":12,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"29905715-eab1-4738-994d-a4ffceab781e"},{"version":"CommandV1","origId":1343992488731458,"guid":"fbce9040-2450-4ca5-85ed-93b963f02581","subtype":"command","commandType":"auto","position":0.875,"command":"cfg = {\n    \"config\":\n        {\n            # ALL FIELDS ARE MANDATORY IN THIS DICTIONARY\n             \"jdbcHostname\":\"10.10.9.4\" # Source Server Address\n            ,\"jdbcPort\":1433    # Source Server Port\n            ,\"jdbcSourceDatabase\":\"NCH_Triyam\" # Source Server Database \n            ,\"jdbcUsername\":\"koantekUser\" # Source Server user\n            ,\"jdbcPassword\":\"aBjO40oTOy&4l0\" # Source Server password\n            ,\"jdbcDriver\":\"com.microsoft.sqlserver.jdbc.SQLServerDriver\" # Source Server JDBC Driver\n            ##\n            #,\"jdbcDriver\":\"oracle.jdbc.driver.OracleDriver\" # Oracle JDBC Driver\n            #,\"jdbcDriver\":\"com.ibm.db2.jcc.DB2Driver\" # DB2\n            #,\"jdbcDriver\":\"org.mariadb.jdbc.Driver\" # MariaDB/MySQL\n            #,\"jdbcDriver\":\"org.postgresql.Driver\" # PostgreSQL\n            ,\"jdbcSourceSchema\":\"triyam\" # Source Database Schema\n            #,\"targetDatabase\":\"koantek_parallel_load\" Target databse for Unity Catalog implementation\n            ,\"targetSchema\":\"koantek_triyam_test\" # Target Server Schema\n            ,\"parallelCores\":8 # Number of vCPUs available in cluster\n        }\n,    \"load\":\n        [\n            {\n                # ONLY table and keyField FIELDS ARE MANDATORY IN THIS DICTIONARY\n                \"table\":\"order_entry_fields\" # source table name\n                ,\"keyField\":\"OE_FIELD_ID\" # source keyfield column name (int, bigint or float)\n             }\n            ,\n            {\n                \"table\":\"oe_format_fields\"\n                ,\"keyField\":\"OE_FORMAT_ID\"\n                # OPTIONAL FIELDS IN THIS DICTIONARY - will increase load time significantly\n                # NOTES\n                # Clustering on a per table will rewrite table after parallel import\n                # Clustering on a per table basis will disable Z-Order and Partitioning\n                ,\"partition\":[\"ACCEPT_FLAG\"] # partitioning column\n                ,\"zorder\":[\"FIELD_SEQ\"] # Z-Order column \n                ,\"cluster\":[\"EPILOG_METHOD\"] # Liquid Clustering Columns\n             }\n        ]    \n}","commandVersion":435,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1690214436555,"submitTime":1690214431243,"finishTime":1690214436650,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Sample JSON Object","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"dc423a49-98fe-47bc-b2d5-6fdcd46fd3df"},{"version":"CommandV1","origId":1343992488731466,"guid":"596ecc40-0523-4e67-8b1f-d7ebb12caef8","subtype":"command","commandType":"auto","position":5.640625,"command":"%md\n## Parallel Load Metrics Table Queries","commandVersion":9,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"749b63eb-3ba7-42dd-9969-5496e41a3618"},{"version":"CommandV1","origId":1343992488731467,"guid":"82017db1-f2da-4ae2-984c-38a620da1109","subtype":"command","commandType":"auto","position":6.265625,"command":"%sql\n--example from final run with additional test runs\nselect \n*\n from koantek_triyam_test.load_metrics","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["koantek_triyam_test.Register_fovea_5252022_final","2023-06-01T11:50:43.422+0000","2023-06-01T11:50:51.368+0000",1318524,1318524,165942.39],["koantek_triyam_test.Tri_V500_EVENT_SET_EXPLODE","2023-06-05T04:55:42.060+0000","2023-06-05T04:55:48.077+0000",500080,500080,83108.87],["koantek_triyam_test.qa100_ce_event_order_link","2023-06-01T11:46:42.954+0000","2023-06-01T11:46:58.679+0000",3751348,3751348,238557.14],["koantek_triyam_test.CUSTOM_RES_COMMENT_DEST","2023-06-01T06:42:35.692+0000","2023-06-01T06:46:18.141+0000",77171506,77171506,346916.53],["koantek_triyam_test.CE_INTAKE_OUTPUT_RESULT","2023-05-31T23:02:03.118+0000","2023-05-31T23:05:27.096+0000",44284279,44284279,217103.55],["koantek_triyam_test.DCP_FORMS_ACTIVITY_COMP","2023-06-01T06:47:00.004+0000","2023-06-01T06:51:13.176+0000",199448507,199448507,787796.94],["koantek_triyam_test.CUSTOM_ES_HIER_DISCRETE","2023-06-01T06:42:14.875+0000","2023-06-01T06:42:18.264+0000",29699,29699,8764.735],["koantek_triyam_test.CE_CALCULATION_RESULT","2023-05-31T18:51:59.051+0000","2023-05-31T18:53:12.866+0000",32887138,32887138,445538.25],["koantek_triyam_test.QA100_V500_EVENT_CODE","2023-06-05T04:54:39.959+0000","2023-06-05T04:54:44.242+0000",62616,62616,14619.127],["koantek_triyam_test.ORDER_CATALOG_SYNONYM","2023-06-01T08:29:31.089+0000","2023-06-01T08:29:37.222+0000",92915,92915,15149.052],["koantek_triyam_test.qa100_clinical_event","2023-06-01T11:48:19.672+0000","2023-06-01T11:50:18.136+0000",6790959,6790959,57325.066],["koantek_triyam_test.qa100_CE_EVENT_PRSNL","2023-06-01T11:47:05.856+0000","2023-06-01T11:48:10.085+0000",10196975,10196975,158758.33],["koantek_triyam_test.QA100_CE_EVENT_NOTE","2023-06-05T04:53:25.198+0000","2023-06-05T04:53:30.231+0000",244025,244025,48486.445],["koantek_triyam_test.CE_CONTRIBUTOR_LINK","2023-05-31T18:53:36.625+0000","2023-05-31T18:55:12.275+0000",90365452,90365452,944746.3],["koantek_triyam_test.V500_EVENT_SET_CODE","2023-06-05T04:55:51.096+0000","2023-06-05T04:55:54.597+0000",36316,36316,10374.346],["koantek_triyam_test.ce_event_order_link","2023-05-31T19:06:29.013+0000","2023-05-31T19:40:08.629+0000",1809480720,1809480720,895952.7],["koantek_triyam_test.DCP_FORMS_ACTIVITY","2023-06-01T06:51:36.834+0000","2023-06-01T06:57:02.468+0000",76614095,76614095,235277.12],["koantek_triyam_test.qa100_ORDER_ACTION","2023-06-05T04:53:35.280+0000","2023-06-05T04:53:56.710+0000",1362041,1362041,63557.08],["koantek_triyam_test.qa100_order_detail","2023-06-05T04:54:04.059+0000","2023-06-05T04:54:22.525+0000",6211816,6211816,336397.8],["koantek_triyam_test.order_entry_fields","2023-06-01T10:31:17.944+0000","2023-06-01T10:31:21.600+0000",1560,1560,426.60587],["koantek_triyam_test.CE_RESULT_SET_LINK","2023-05-31T23:13:14.588+0000","2023-05-31T23:19:24.167+0000",236212525,236212525,639138.75],["koantek_triyam_test.ACCESSION_ORDER_R","2023-05-31T18:39:17.224+0000","2023-05-31T18:41:25.083+0000",40168310,40168310,314161.1],["koantek_triyam_test.CE_SPECIMEN_COLL","2023-05-31T23:19:56.145+0000","2023-05-31T23:24:20.664+0000",129204208,129204208,488449.94],["koantek_triyam_test.oe_format_fields","2023-06-01T07:19:23.595+0000","2023-06-01T07:19:27.908+0000",11190,11190,2594.2654],["koantek_triyam_test.ORDER_INGREDIENT","2023-06-01T10:31:36.903+0000","2023-06-01T10:36:47.835+0000",53564966,53564966,172272.2],["koantek_triyam_test.Tri_person_alias","2023-06-05T04:54:50.026+0000","2023-06-05T04:55:36.145+0000",6666631,6666631,144552.67],["koantek_triyam_test.PREGNANCY_CHILD","2023-06-05T04:53:15.749+0000","2023-06-05T04:53:21.102+0000",79305,79305,14813.994],["koantek_triyam_test.MESSAGING_AUDIT","2023-06-01T07:16:27.205+0000","2023-06-01T07:18:25.997+0000",19333431,19333431,162750.3],["koantek_triyam_test.CE_DATE_RESULT","2023-05-31T18:55:31.555+0000","2023-05-31T18:57:33.235+0000",78294156,78294156,643446.5],["koantek_triyam_test.clinical_event","2023-06-01T00:32:01.239+0000","2023-06-01T06:41:49.852+0000",4521375790,4521375790,203770.1],["koantek_triyam_test.CE_EVENT_PRSNL","2023-05-31T19:59:23.458+0000","2023-05-31T23:01:49.607+0000",5677860684,5677860684,518708.47],["koantek_triyam_test.ORDER_COMMENT","2023-06-01T08:30:36.285+0000","2023-06-01T08:36:55.075+0000",236713728,236713728,624920.8],["koantek_triyam_test.ORDER_PRODUCT","2023-06-01T10:37:01.586+0000","2023-06-01T10:38:38.500+0000",39209705,39209705,404586.3],["koantek_triyam_test.Tri_Encounter","2023-06-01T11:50:56.685+0000","2023-06-01T11:54:04.688+0000",12969907,12969907,68987.625],["koantek_triyam_test.ACT_PW_COMP_1","2023-05-31T18:41:55.462+0000","2023-05-31T18:48:07.913+0000",70416613,70416613,189062.47],["koantek_triyam_test.CE_MED_RESULT","2023-05-31T23:05:48.527+0000","2023-05-31T23:12:16.547+0000",80023720,80023720,206236.02],["koantek_triyam_test.CE_EVENT_NOTE","2023-05-31T18:57:57.618+0000","2023-05-31T19:00:51.855+0000",79791351,79791351,457948.25],["koantek_triyam_test.ORDER_CATALOG","2023-06-01T08:29:40.227+0000","2023-06-01T08:29:44.075+0000",21464,21464,5577.2583],["koantek_triyam_test.ORGANIZATION","2023-06-01T11:45:02.598+0000","2023-06-01T11:45:10.004+0000",282412,282412,38132.57],["koantek_triyam_test.ORDER_ACTION","2023-06-01T07:22:40.295+0000","2023-06-01T08:29:26.560+0000",951703510,951703510,237553.8],["koantek_triyam_test.order_detail","2023-06-01T08:56:32.102+0000","2023-06-01T10:31:13.741+0000",4001222553,4001222553,704237.44],["koantek_triyam_test.NOMENCLATURE","2023-06-01T07:18:59.723+0000","2023-06-01T07:19:20.735+0000",3799401,3799401,180818.73],["koantek_triyam_test.ORDER_REVIEW","2023-06-01T10:39:32.743+0000","2023-06-01T10:47:02.275+0000",235949009,235949009,524877.1],["koantek_triyam_test.QA100_ORDERS","2023-06-01T11:50:22.042+0000","2023-06-01T11:50:40.495+0000",645476,645476,34979.543],["koantek_triyam_test.MIC_TASK_LOG","2023-06-01T07:18:33.379+0000","2023-06-01T07:18:51.697+0000",3417083,3417083,186544.64],["koantek_triyam_test.ENCNTR_ALIAS","2023-06-05T04:51:00.488+0000","2023-06-05T04:53:02.296+0000",23525611,23525611,193136.9],["koantek_triyam_test.TRI_Person","2023-06-01T11:54:36.193+0000","2023-06-01T11:56:50.856+0000",10641211,10641211,79021.14],["koantek_triyam_test.CODE_VALUE","2023-06-01T06:42:01.061+0000","2023-06-01T06:42:11.891+0000",357423,357423,33003.977],["koantek_triyam_test.LONG_TEXT","2023-06-01T06:58:42.347+0000","2023-06-01T07:16:09.455+0000",506017834,506017834,483252.78],["koantek_triyam_test.Tri_PRSNL","2023-06-01T11:57:04.634+0000","2023-06-01T11:57:18.457+0000",416713,416713,30145.309],["koantek_triyam_test.ADDRESS","2023-05-31T18:48:32.484+0000","2023-05-31T18:51:39.135+0000",31754495,31754495,170127.39],["koantek_triyam_test.PATHWAY","2023-06-01T11:45:14.121+0000","2023-06-01T11:46:38.403+0000",6181463,6181463,73342.484],["koantek_triyam_test.ORDERS","2023-06-01T10:48:16.806+0000","2023-06-01T11:44:53.616+0000",467317732,467317732,137575.47]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"table_name","type":"\"string\"","metadata":"{}"},{"name":"load_begin","type":"\"timestamp\"","metadata":"{}"},{"name":"load_end","type":"\"timestamp\"","metadata":"{}"},{"name":"begin_rowcount","type":"\"long\"","metadata":"{}"},{"name":"end_rowcount","type":"\"long\"","metadata":"{}"},{"name":"rows_per_second","type":"\"float\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"table_name","nullable":true,"type":"string"},{"metadata":{},"name":"load_begin","nullable":true,"type":"timestamp"},{"metadata":{},"name":"load_end","nullable":true,"type":"timestamp"},{"metadata":{},"name":"begin_rowcount","nullable":true,"type":"long"},{"metadata":{},"name":"end_rowcount","nullable":true,"type":"long"},{"metadata":{},"name":"rows_per_second","nullable":true,"type":"float"}],"type":"struct"},"tableIdentifier":null}],"columnCustomDisplayInfos":{},"metadata":{"dataframeName":"_sqldf","executionCount":5}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"table_name","nullable":true,"type":"string"},{"metadata":{},"name":"load_begin","nullable":true,"type":"timestamp"},{"metadata":{},"name":"load_end","nullable":true,"type":"timestamp"},{"metadata":{},"name":"begin_rowcount","nullable":true,"type":"long"},{"metadata":{},"name":"end_rowcount","nullable":true,"type":"long"},{"metadata":{},"name":"rows_per_second","nullable":true,"type":"float"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1687333746675,"submitTime":1687333746656,"finishTime":1687333759458,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000,"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",53]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"782d54a7-24d1-40ae-9e96-d8a2871e74c6"},{"version":"CommandV1","origId":1343992488731468,"guid":"0893fbf9-5ace-4770-89c2-348d71946dee","subtype":"command","commandType":"auto","position":6.515625,"command":"%sql\n--threshold for slowest 5% of Rows per Second throughput\nselect \n percentile( rows_per_second,0.05)\n from koantek_triyam_test.load_metrics","commandVersion":33,"state":"finished","results":{"type":"table","data":[[7489.74453125]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"percentile(rows_per_second, 0.05, 1)","type":"\"double\"","metadata":"{\"__autoGeneratedAlias\":\"true\"}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1686757554771,"submitTime":1686757554753,"finishTime":1686757557687,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000,"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"93275b05-4339-4c53-8fcf-a9a389393436"},{"version":"CommandV1","origId":1343992488731469,"guid":"8874f964-d899-43f8-98dd-983fdddce03e","subtype":"command","commandType":"auto","position":7.015625,"command":"%sql\n--Range of Rows per Second throughput\nselect \nmin(rows_per_second)\n,avg(rows_per_second)\n from koantek_triyam_test.load_metrics","commandVersion":41,"state":"finished","results":{"type":"table","data":[[426.60587,253651.40957871923]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"min(rows_per_second)","type":"\"float\"","metadata":"{\"__autoGeneratedAlias\":\"true\"}"},{"name":"avg(rows_per_second)","type":"\"double\"","metadata":"{\"__autoGeneratedAlias\":\"true\"}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1686757239801,"submitTime":1686757239785,"finishTime":1686757246315,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000,"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a91ee473-353d-4cc6-8cef-e2b99a633829"},{"version":"CommandV1","origId":1343992488731470,"guid":"ddde2c0e-1866-46d8-ad95-967926f0e453","subtype":"tableResultSubCmd.visualization","commandType":"auto","position":7.265625,"command":"%sql WITH q AS (select \n*\n from koantek_triyam_test.load_metrics) SELECT `end_rowcount`,`rows_per_second` FROM q","commandVersion":0,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"redashChart","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{"redashChart":[{"key":"type","value":"CHART"},{"key":"options","value":{"series":{"stacking":null,"error_y":{"type":"data","visible":true}},"coefficient":1,"yAxis":[{"type":"-"},{"type":"-","opposite":true}],"columnConfigurationMap":{"x":{"column":"end_rowcount","id":"column_99e11c521"},"y":[{"column":"rows_per_second","id":"column_99e11c522"}]},"alignYAxesAtZero":true,"direction":{"type":"counterclockwise"},"swappedAxes":false,"percentFormat":"0[.]00%","textFormat":"","legend":{"traceorder":"normal"},"globalSeriesType":"scatter","version":2,"sizemode":"diameter","seriesOptions":{"rows_per_second":{"yAxis":0,"type":"scatter"}},"error_y":{"type":"data","visible":true},"sortX":true,"showDataLabels":false,"missingValuesAsZero":true,"useAggregationsUi":true,"numberFormat":"0,0[.]00000","dateTimeFormat":"DD/MM/YYYY HH:mm","sortY":true,"valuesOptions":{},"xAxis":{"type":"logarithmic","labels":{"enabled":true}}}}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":["82017db1-f2da-4ae2-984c-38a620da1109"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Visualization 1","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":0,"listResultMetadata":null,"subcommandOptions":{"queryPlan":{"selects":[{"column":"end_rowcount","type":"column"},{"column":"rows_per_second","type":"column"}]}},"contentSha256Hex":null,"nuid":"093e7523-81c9-4955-bc76-ab287e1484cf"},{"version":"CommandV1","origId":1343992488731492,"guid":"377e7f45-9ad4-4174-a72b-1e5e0a561b47","subtype":"command","commandType":"auto","position":0.93359375,"command":"with open('/dbfs/LoadConfig/sample.json', 'w') as openfile:\n    openfile.write(str(cfg))","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1690214467796,"submitTime":1690214467770,"finishTime":1690214467895,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Writing JSON to DBFS","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"23bce2fe-9f08-4a63-a022-b50517aded52"},{"version":"CommandV1","origId":1343992488731493,"guid":"8248bb3a-3794-44a4-a8f0-8ebd941e00e2","subtype":"command","commandType":"auto","position":0.904296875,"command":"%md\n### Writing JSON to Disk","commandVersion":9,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fd49c151-fd9b-4118-a062-1f6f3230bf01"},{"version":"CommandV1","origId":1343992488731650,"guid":"ee20a313-8ba1-4ec3-859d-95de001ef3d6","subtype":"command","commandType":"auto","position":0.962890625,"command":"%fs head dbfs:/LoadConfig/sample.json","commandVersion":5,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">{'config': {'jdbcHostname': '10.10.9.4', 'jdbcPort': 1433, 'jdbcSourceDatabase': 'NCH_Triyam', 'jdbcUsername': 'koantekUser', 'jdbcPassword': 'aBjO40oTOy&amp;4l0', 'jdbcDriver': 'com.microsoft.sqlserver.jdbc.SQLServerDriver', 'jdbcSourceSchema': 'triyam', 'targetSchema': 'koantek_triyam_test', 'parallelCores': 4}, 'load': [{'table': 'order_entry_fields', 'keyField': 'OE_FIELD_ID'}, {'table': 'oe_format_fields', 'keyField': 'OE_FORMAT_ID', 'partition': ['ACCEPT_FLAG'], 'zorder': ['FIELD_SEQ'], 'cluster': ['EPILOG_METHOD']}]}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1690214532120,"submitTime":1690214532091,"finishTime":1690214532377,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Verifying Write","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",557]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1eb080c9-4cc7-40bb-bb51-4979640c771a"},{"version":"CommandV1","origId":1343992488731652,"guid":"96ef8cd5-0d8b-401e-8ed0-2940fe6637a5","subtype":"command","commandType":"auto","position":3.3017578125,"command":"%md\n### Scheduling Job for Execution\nBoth commands below will run a notebook and return its exit value. The method starts an ephemeral job that runs immediately.\n\nFor scheduling jobs see the Databricks article [Run jobs on a schedule or continuously\n](https://docs.databricks.com/workflows/jobs/schedule-jobs.html#add-a-job-schedule)\n\n#### Example executions\n\n**Magic command**\n```bash\n%run \"/Users/drew.minkin@koantek.com/Triyam Final Deliverables/Koantek Parallel Load\" $configuration_file=\"/dbfs/LoadConfig/sample.json\"\n```\n\n**dbutils API**\n\nThe second **timeout_seconds** parameter controls the timeout of the run (0 means no timeout): the call to run throws an exception if it doesn’t finish within the specified time. If Databricks is down for more than 10 minutes, the notebook run fails regardless of timeout_seconds.\n```python\ndbutils.notebook.run(\"notebook-name\", 0, {\"configuration_file\": \"/dbfs/LoadConfig/sample.json\"})\n```","commandVersion":121,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"78e3a561-f7bf-47a7-a803-06bbdcec6be1"}],"dashboards":[],"guid":"9371e5a6-3d9c-4866-b8e0-8db8944b34bd","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"configuration_file":{"nuid":"5450a7e0-3f51-446e-a21e-bf7ff7eccba8","currentValue":"/dbfs/LoadConfig/sample.json","widgetInfo":{"widgetType":"text","name":"configuration_file","defaultValue":"dbfs:/LoadConfig/sample.json","label":null,"options":{"widgetType":"text","validationRegex":null}}}},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":1343992488731650,"dataframes":["_sqldf"]}},"reposExportFormat":"SOURCE"}